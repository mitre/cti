{
    "type": "bundle",
    "id": "bundle--8b6d7648-5fa6-4c3a-84fd-1cb9229a9854",
    "spec_version": "2.0",
    "objects": [
        {
            "type": "x-mitre-analytic",
            "id": "x-mitre-analytic--d1d19568-2b59-4d44-9744-22d7304d2200",
            "created": "2025-10-21T15:10:28.402Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/detectionstrategies/DET0369#AN1038",
                    "external_id": "AN1038"
                }
            ],
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "modified": "2025-10-21T15:10:28.402Z",
            "name": "Analytic 1038",
            "description": "Correlate file modifications in shell startup scripts (e.g., .bashrc, .profile) with embedded `trap` commands and observe if those changes are followed by the unexpected execution of child processes when terminal signals (e.g., SIGINT) are triggered. Use contextual linking with user session activity to detect privilege misuse.",
            "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_version": "1.0",
            "x_mitre_attack_spec_version": "3.3.0",
            "x_mitre_domains": [
                "enterprise-attack"
            ],
            "x_mitre_platforms": [
                "Linux"
            ],
            "x_mitre_log_source_references": [
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--3d20385b-24ef-40e1-9f56-f39750379077",
                    "name": "auditd:SYSCALL",
                    "channel": "execve"
                },
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--84572de3-9583-4c73-aabd-06ea88123dd8",
                    "name": "auditd:SYSCALL",
                    "channel": "Modification of user shell profile or trap registration via echo/redirection (e.g., echo \"trap 'malicious_cmd' INT\" >> ~/.bashrc)"
                },
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--235b7491-2d2b-4617-9a52-3c0783680f71",
                    "name": "auditd:SYSCALL",
                    "channel": "open"
                }
            ],
            "x_mitre_mutable_elements": [
                {
                    "field": "TargetShellFilePath",
                    "description": "The path to user profile scripts (e.g., ~/.bashrc, ~/.zshrc); may differ by distro or shell type."
                },
                {
                    "field": "SignalTrapName",
                    "description": "Trap signal (e.g., INT, HUP, TERM) can be environment-specific or attacker-tuned to evade."
                },
                {
                    "field": "TimeWindow",
                    "description": "Temporal threshold to correlate trap insertion and process execution (e.g., 10s-5min)"
                }
            ],
            "x_mitre_deprecated": false
        }
    ]
}