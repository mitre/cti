{
    "type": "bundle",
    "id": "bundle--b52a7627-d264-4fe3-93b5-b9d573749135",
    "spec_version": "2.0",
    "objects": [
        {
            "type": "x-mitre-analytic",
            "id": "x-mitre-analytic--de1d4807-fcb5-4112-b310-ea0c4df45af2",
            "created": "2025-10-21T15:10:28.402Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/detectionstrategies/DET0597#AN1643",
                    "external_id": "AN1643"
                }
            ],
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "modified": "2025-10-21T15:10:28.402Z",
            "name": "Analytic 1643",
            "description": "Detection of password manager database access (1Password .opvault, LastPass caches, KeePass .kdbx) outside expected parent processes. Identifies memory scraping attempts via suspicious API calls or tools attaching to password manager processes.",
            "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_version": "1.0",
            "x_mitre_attack_spec_version": "3.3.0",
            "x_mitre_domains": [
                "enterprise-attack"
            ],
            "x_mitre_platforms": [
                "macOS"
            ],
            "x_mitre_log_source_references": [
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--3d20385b-24ef-40e1-9f56-f39750379077",
                    "name": "macos:unifiedlog",
                    "channel": "security OR injection attempts into 1Password OR LastPass"
                },
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--235b7491-2d2b-4617-9a52-3c0783680f71",
                    "name": "macos:unifiedlog",
                    "channel": "*.opvault OR *.ldb OR *.kdbx"
                },
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--1887a270-576a-4049-84de-ef746b2572d6",
                    "name": "macos:osquery",
                    "channel": "unexpected memory inspection"
                }
            ],
            "x_mitre_mutable_elements": [
                {
                    "field": "VaultFileExtensions",
                    "description": "Password manager file extensions (.opvault, .kdbx, .ldb) to monitor for anomalous access."
                },
                {
                    "field": "ParentProcessWhitelist",
                    "description": "Expected parent processes that normally access password manager files, for filtering false positives."
                }
            ],
            "x_mitre_deprecated": false
        }
    ]
}