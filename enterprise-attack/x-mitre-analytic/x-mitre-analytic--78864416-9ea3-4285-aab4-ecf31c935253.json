{
    "type": "bundle",
    "id": "bundle--ba963331-f69b-4052-98a6-5972ac895225",
    "spec_version": "2.0",
    "objects": [
        {
            "type": "x-mitre-analytic",
            "id": "x-mitre-analytic--78864416-9ea3-4285-aab4-ecf31c935253",
            "created": "2025-10-21T15:10:28.402Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/detectionstrategies/DET0455#AN1252",
                    "external_id": "AN1252"
                }
            ],
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "modified": "2025-11-12T22:03:39.105Z",
            "name": "Analytic 1252",
            "description": "Detects behavioral chains where PowerShell is launched with encoded commands, unusual parent processes, or suspicious modules loaded, potentially followed by network connections or child process spawning. Supports detection of both direct (powershell.exe) and indirect (.NET automation) invocations.",
            "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_deprecated": false,
            "x_mitre_version": "1.0",
            "x_mitre_attack_spec_version": "3.3.0",
            "x_mitre_domains": [
                "enterprise-attack"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_log_source_references": [
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--3d20385b-24ef-40e1-9f56-f39750379077",
                    "name": "WinEventLog:Sysmon",
                    "channel": "EventCode=1"
                },
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--685f917a-e95e-4ba0-ade1-c7d354dae6e0",
                    "name": "WinEventLog:PowerShell",
                    "channel": "EventCode=4103, 4104, 4105, 4106"
                },
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--ee575f4a-2d4f-48f6-b18b-89067760adc1",
                    "name": "WinEventLog:PowerShell",
                    "channel": "EventCode=400, 403"
                },
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--c0a4a086-cc20-4e1e-b7cb-29d99dfa3fb1",
                    "name": "WinEventLog:Sysmon",
                    "channel": "EventCode=7"
                }
            ],
            "x_mitre_mutable_elements": [
                {
                    "field": "CommandLinePattern",
                    "description": "Regex pattern for encoded, obfuscated, or hidden PowerShell arguments (e.g., '-enc', '-nop')."
                },
                {
                    "field": "ParentProcessName",
                    "description": "Filter based on abnormal parents like Excel, WinWord, or mshta spawning PowerShell."
                },
                {
                    "field": "TimeWindow",
                    "description": "Scope detection to off-hours, lateral movement timeframes, or non-maintenance windows."
                },
                {
                    "field": "LoadedModuleList",
                    "description": "Tuneable to monitor rare or never-before-seen .NET assemblies tied to PowerShell abuse."
                },
                {
                    "field": "ScriptBlockLengthThreshold",
                    "description": "Adjustable threshold for length of script blocks logged by Event ID 4104 (useful for filtering noise)."
                }
            ]
        }
    ]
}