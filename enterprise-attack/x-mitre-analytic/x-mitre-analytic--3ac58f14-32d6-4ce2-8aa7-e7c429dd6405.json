{
    "type": "bundle",
    "id": "bundle--d21e823d-cbf2-4d9b-b2e0-e425f99435c9",
    "spec_version": "2.0",
    "objects": [
        {
            "type": "x-mitre-analytic",
            "id": "x-mitre-analytic--3ac58f14-32d6-4ce2-8aa7-e7c429dd6405",
            "created": "2025-10-21T15:10:28.402Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/detectionstrategies/DET0061#AN0170",
                    "external_id": "AN0170"
                }
            ],
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "modified": "2025-11-12T22:03:39.105Z",
            "name": "Analytic 0170",
            "description": "Detects modification of registry keys used for default file handlers, followed by anomalous process execution from user-initiated file opens. This includes tracking changes under HKCU and HKCR for file extension mappings, and correlating them with new or suspicious handler paths launching unusual child processes (e.g., PowerShell, cmd, wscript).",
            "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_deprecated": false,
            "x_mitre_version": "1.0",
            "x_mitre_attack_spec_version": "3.3.0",
            "x_mitre_domains": [
                "enterprise-attack"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_log_source_references": [
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--da85d358-741a-410d-9433-20d6269a6170",
                    "name": "WinEventLog:Sysmon",
                    "channel": "EventCode=13, 14"
                },
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--3d20385b-24ef-40e1-9f56-f39750379077",
                    "name": "WinEventLog:Sysmon",
                    "channel": "EventCode=1"
                },
                {
                    "x_mitre_data_component_ref": "x-mitre-data-component--39b9db72-8b48-4595-a18d-db5bbba3091b",
                    "name": "WinEventLog:Security",
                    "channel": "EventCode=4672"
                }
            ],
            "x_mitre_mutable_elements": [
                {
                    "field": "TimeWindow",
                    "description": "Defines how long after the registry modification to correlate a suspicious process execution"
                },
                {
                    "field": "UserContext",
                    "description": "Tune to ignore known admin or installer behavior in specific user profiles"
                },
                {
                    "field": "SuspiciousHandlerPathRegex",
                    "description": "Pattern match for suspicious handler paths (e.g., powershell.exe, rundll32.exe)"
                }
            ]
        }
    ]
}