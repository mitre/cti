{
    "id": "bundle--16cf102f-8dda-43c8-99a0-b9c9b8e834c0",
    "objects": [
        {
            "created": "2017-05-31T21:31:07.462Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "description": "Windows User Account Control (UAC) allows a program to elevate its privileges to perform a task under administrator-level permissions by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action.DLL Injection and unusual loaded DLLs through DLL Search Order Hijacking, which indicate attempts to gain access to higher privileged processes.\n\nSome UAC bypass methods rely on modifying specific, user-accessible Registry settings.  For example:\n\n* The <code>eventvwr.exe</code> bypass uses the <code>[HKEY_CURRENT_USER]\\Software\\Classes\\mscfile\\shell\\open\\command</code> Registry key.[[Citation: enigma0x3 Fileless UAC Bypass]]\n* The <code>sdclt.exe</code> bypass uses the <code>[HKEY_CURRENT_USER]\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\control.exe</code> and <code>[HKEY_CURRENT_USER]\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand</code> Registry keys.[[Citation: enigma0x3 sdclt app paths]][[Citation: enigma0x3 sdclt bypass]]\n\nAnalysts should monitor these Registry settings for unauthorized changes.\n\nPlatforms: Windows Server 2012, Windows 7, Windows 8, Windows Server 2008 R2, Windows Server 2012 R2, Windows 8.1, Windows 10\n\nData Sources: System calls, Process monitoring, Authentication logs, Process command-line parameters\n\nEffective Permissions: Administrator\n\nContributors: Stefan Kanthak, Casey Smith",
            "external_references": [
                {
                    "external_id": "T1088",
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/wiki/Technique/T1088"
                },
                {
                    "description": "Nelson, M. (2016, August 15). \"Fileless\" UAC Bypass using eventvwr.exe and Registry Hijacking. Retrieved December 27, 2016.",
                    "source_name": "enigma0x3 Fileless UAC Bypass",
                    "url": "https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/"
                },
                {
                    "description": "UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016.",
                    "source_name": "Github UACMe",
                    "url": "https://github.com/hfiref0x/UACME"
                },
                {
                    "description": "Lich, B. (2016, May 31). How User Account Control Works. Retrieved June 3, 2016.",
                    "source_name": "TechNet How UAC Works",
                    "url": "https://technet.microsoft.com/en-us/itpro/windows/keep-secure/how-user-account-control-works"
                },
                {
                    "description": "Nelson, M. (2017, March 14). Bypassing UAC using App Paths. Retrieved May 25, 2017.",
                    "source_name": "enigma0x3 sdclt app paths",
                    "url": "https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/"
                },
                {
                    "description": "Microsoft. (n.d.). The COM Elevation Moniker. Retrieved July 26, 2016.",
                    "source_name": "MSDN COM Elevation",
                    "url": "https://msdn.microsoft.com/en-us/library/ms679687.aspx"
                },
                {
                    "description": "Nelson, M. (2017, March 17). \"Fileless\" UAC Bypass Using sdclt.exe. Retrieved May 25, 2017.",
                    "source_name": "enigma0x3 sdclt bypass",
                    "url": "https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/"
                },
                {
                    "description": "Russinovich, M. (2009, July). User Account Control: Inside Windows 7 User Account Control. Retrieved July 26, 2016.",
                    "source_name": "TechNet Inside UAC",
                    "url": "https://technet.microsoft.com/en-US/magazine/2009.07.uac.aspx"
                },
                {
                    "description": "Davidson, L. (n.d.). Windows 7 UAC whitelist. Retrieved November 12, 2014.",
                    "source_name": "Davidson Windows",
                    "url": "http://www.pretentiousname.com/misc/win7%20uac%20whitelist2.html"
                },
                {
                    "description": "Medin, T. (2013, August 8). PsExec UAC Bypass. Retrieved June 3, 2016.",
                    "source_name": "SANS UAC Bypass",
                    "url": "http://pen-testing.sans.org/blog/pen-testing/2013/08/08/psexec-uac-bypass"
                },
                {
                    "description": "Salvio, J., Joven, R. (2016, December 16). Malicious Macro Bypasses UAC to Elevate Privilege for Fareit Malware. Retrieved December 27, 2016.",
                    "source_name": "Fortinet Fareit",
                    "url": "https://blog.fortinet.com/2016/12/16/malicious-macro-bypasses-uac-to-elevate-privilege-for-fareit-malware"
                }
            ],
            "id": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "privilege-escalation"
                }
            ],
            "modified": "2017-07-28T15:03:01.272Z",
            "name": "Bypass User Account Control",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "x_mitre_contributors": [
                "Stefan Kanthak",
                "Casey Smith"
            ],
            "x_mitre_data_sources": [
                "System calls",
                "Process monitoring",
                "Authentication logs",
                "Process command-line parameters"
            ],
            "x_mitre_effective_permissions": [
                "Administrator"
            ],
            "x_mitre_platforms": [
                "Windows Server 2012",
                "Windows 7",
                "Windows 8",
                "Windows Server 2008 R2",
                "Windows Server 2012 R2",
                "Windows 8.1",
                "Windows 10"
            ]
        }
    ],
    "spec_version": "2.0",
    "type": "bundle"
}